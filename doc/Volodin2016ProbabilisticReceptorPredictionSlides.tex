\documentclass{beamer}
\newcommand{\x}{\mathbf{x}}
\newcommand{\w}{\mathbf{w}}
\newcommand{\W}{\mathbf{W}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\fx}{\mathbf{f}}
\newcommand{\fs}{\mbox{f}}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath,mathrsfs,mathtext}
\usepackage{graphicx, epsfig}
\usetheme{Warsaw}%{Singapore}%{Warsaw}%{Warsaw}%{Darmstadt}
\usecolortheme{sidebartab}
\definecolor{beamer@blendedblue}{RGB}{15,120,80}
%----------------------------------------------------------------------------------------------------------
\title[\hbox to 56mm{Предсказание активности рецепторов  \hfill\insertframenumber\,/\,\inserttotalframenumber}]
{Вероятностный подход для задачи предсказания биологической активности ядерных рецепторов}
\author[С.\,Е. Володин]{\large \\Володин Сергей Евгеньевич}
\institute{\large Московский физико-технический институт}

\date{\footnotesize{\emph{Курс:} Численные методы обучения по прецедентам\par (практика, В.\,В. Стрижов)/Группа 374, осень 2016}}
%-------------------------------------------------------
\begin{document}
%-------------------------------------------------------
\begin{frame}
%\thispagestyle{empty}
\titlepage
\end{frame}
%-------------------------------------------------------
\begin{frame}{Цель исследования}
Предсказание взаимодействия двух типов молекул: лиганд и рецепторов. Необходимо оценить вероятность связывания.
\begin{block}{Проблема}
События реакции лиганда с различными рецепторами не независимы.
%В ответах содержатся пропуски, поэтому независимое рассмотрение рецепторов дает неудовлетворительное качество классификации.
%События реакции лиганда с различными рецепторами не независимы.
%Экспертные знания в области биохимии и фармакологии дают основания пред-
%полагать, что факты связывания одних и тех же молекул с различными рецепторами не
%независимы.
\end{block}
%Оказывается, что события реакции лиганда с различными рецепторами не независимы.
\begin{block}{Задача}
Необходимо построить вероятностную модель, учитывающую зависимости между классами, а также построить бинарный классификатор.
\end{block}
\end{frame}
%-------------------------------------------------------
\begin{frame}{Проблема}
\includegraphics{dependence}
\end{frame}
%-------------------------------------------------------
\begin{frame}{Литература}
\begin{enumerate}
	\item Olexandr Isayev Sherif Farag Stephen J. Capuzzi, Regina Politi and Alexander Tropsha. Qsar
	modeling of tox21 challenge stress response and nuclear receptor signaling toxicity assays.
	\item Geoff Holmes Eibe Frank Jesse Read, Bernhard Pfahringer. Classifier chains for multi-label
	classification.
	\item Eyke H.0 Krzysztof Dembczynski, Weiwei Cheng. Bayes optimal multilabel classification via
	probabilistic classifier chains. 2010.
\end{enumerate}
\end{frame}
%-------------------------------------------------------
\begin{frame}{Постановка задачи}
Задана выборка $\mathfrak{D}=\{(\x_i,\y_i)\}=\mathfrak{L}\sqcup\mathfrak{T}$. $\x_i\in \mathbb{R}^n$. $\y_i\in \{0,1,\Box\}^l$, $\Box$~--- пропуск в данных.
	
$\X, \Y$~--- случайные величины, между классами есть зависимости.

Модель классификации: функция $\fs\colon \W\times\X\times\Y\to [0,1]$, $$\fs(\w,\x,\y)=P(\Y=\y|\X=\x;\w)$$
	
	Функция потерь~--- логарифм правдоподобия
	$$Q(\fs|\w, \mathcal{Z})=-\sum_{(\x,\y)\in\mathcal{Z}}\log \fs(\w,\x,\y)P(\X=\x)$$
	
	Требуется минимизировать $Q$:
	$$\w^*=\underset{{\w\in\W}}{\arg\min}Q(\fs|\w,\mathfrak{L})$$
	
	Для оценки конкретной модели используется AUC.
\end{frame}
%-------------------------------------------------------
\begin{frame}{Решение}
%Распишем вероятность, ...

%{\em Слайд появится после T, пока тут пусто}
\end{frame}
%-------------------------------------------------------
\begin{frame}{Вычислительный эксперимент}
\begin{block}{Цель эксперимента}
\begin{enumerate}
	\item Сравнение различных моделей по критерию AUC для различных классов.
	\item Выбор гиперпараметров исходя из внешних требований к решению задачи.
\end{enumerate}
\end{block}
\begin{block}{Сравниваемые модели}
\begin{enumerate}
	\item Binary Relevance
	\item {\bf PCC}~--- предлагаемое решение
	\item Random Forest
\end{enumerate}
\end{block}
\end{frame}
\begin{frame}{Вычислительный эксперимент}
\begin{table}[t]%\small
	\begin{tabular}{cc}
	BR & PCC\\
\includegraphics[width=0.45\textwidth]{class2} &
\includegraphics[width=0.45\textwidth]{class2_pcc}\\
\includegraphics[width=0.45\textwidth]{class3} &
\includegraphics[width=0.45\textwidth]{class3_pcc}\\
	\end{tabular}
\end{table}
\end{frame}

\begin{frame}{Вычислительный эксперимент}
	\begin{table}[t]%\small
		\begin{tabular}{cc}
			BR & PCC\\
			\includegraphics[width=0.45\textwidth]{class8} &
			\includegraphics[width=0.45\textwidth]{class8_pcc}\\
			\includegraphics[width=0.45\textwidth]{class12} &
			\includegraphics[width=0.45\textwidth]{class12_pcc}\\
		\end{tabular}
	\end{table}
\end{frame}

\begin{frame}{Вычислительный эксперимент}
Зависимость от гиперпараметров\\
\centering \includegraphics[width=0.9\textwidth]{hyper5}

\end{frame}

\begin{frame}{Вычислительный эксперимент}
{\bf Результаты эксперимента}
\begin{table}[t]%\small
	\centering\medskip%\tabcolsep=2pt%\small
	\begin{tabular}{lrrr}
%		\hline
		Рецептор
		
		& Binary Relevance
		& {\bf PCC}
		& Random Forest\\
%		\hline
		
% 0
		{\tt NR-AhR}
		& $\mathbf{0.83} \pm 0.03$
		& $\mathbf{0.83}$
		& $\mathbf{0.93}$
		\\

% 1		
		{\tt NR-AR-LBD}
		& $\mathbf{0.86} \pm 0.08$
		& $\mathbf{0.90}$
		& $\mathbf{0.88}$
		\\

% 2		
		{\tt NR-AR}
		& $\mathbf{0.83} \pm 0.09$
		& $\mathbf{0.84}$
		& $\mathbf{0.83}$
\\
	
% 3	
		{\tt SR-MMP}
		& $\mathbf{0.87} \pm 0.03$
		& $\mathbf{0.87}$
		& $\mathbf{0.95}$
		\\

% 4	
		{\tt NR-ER}
		& $\mathbf{0.78} \pm 0.04$
		& $\mathbf{0.78}$
		& $\mathbf{0.81}$
		\\

% 5	
		{\tt SR-HSE}
		& $\mathbf{0.79} \pm 0.04$
		& $\mathbf{0.78}$
		& $\mathbf{0.86}$
		\\

% 6	
		{\tt SR-p53}
		& $\mathbf{0.79} \pm 0.07$
		& $\mathbf{0.80}$
		& $\mathbf{0.88}$
		\\

% 7	
		{\tt NR-PPAR-gamma}
		& $\mathbf{0.79} \pm 0.04$
		& $\mathbf{0.81}$
		& $\mathbf{0.86}$
\\

% 8	
		{\tt SR-ARE}
		& $\mathbf{0.78} \pm 0.02$
		& $\mathbf{0.78}$
		& $\mathbf{0.84}$
\\

% 9	
		{\tt NR-Aromatase}
		& $\mathbf{0.81} \pm 0.05$
		& $\mathbf{0.82}$
		& $\mathbf{0.84}$
\\

% 10	
		{\tt SR-ATAD5}
		& $\mathbf{0.81} \pm 0.06$
		& $\mathbf{0.80}$
		& $\mathbf{0.83}$
\\

% 11	
		{\tt NR-ER-LBD}
		& $\mathbf{0.80} \pm 0.07$
		& $\mathbf{0.82}$
		& $\mathbf{0.83}$
\\
%		\hline
	\end{tabular}
\end{table}
\end{frame}

%-------------------------------------------------------
\begin{frame}{Заключение}
\begin{enumerate}
	\item Предложена модель для предсказания взаимодействия, учитывающая зависимости между классами
	\item Проведено сравнение модели с другими по критерию AUC
	\item Базовая модель BR имеет худшие показатели AUC, чем Random Forest
	\item PCC лучше BR для большинства классов по критерию AUC при верных значениях гиперпараметров
\end{enumerate}
\end{frame}
%-------------------------------------------------------
\end{document} 