\documentclass{beamer}
\newcommand{\x}{\mathbf{x}}
\newcommand{\w}{\mathbf{w}}
\newcommand{\W}{\mathbf{W}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\X}{\mathbf{X}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\fx}{\mathbf{f}}
\newcommand{\fs}{\mbox{f}}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath,mathrsfs,mathtext}
\usepackage{graphicx, epsfig}
\usetheme{Warsaw}%{Singapore}%{Warsaw}%{Warsaw}%{Darmstadt}
\usecolortheme{sidebartab}
\definecolor{beamer@blendedblue}{RGB}{15,120,80}
%----------------------------------------------------------------------------------------------------------
\title[\hbox to 56mm{Предсказание активности рецепторов  \hfill\insertframenumber\,/\,\inserttotalframenumber}]
{Вероятностный подход для задачи предсказания биологической активности ядерных рецепторов}
\author[С.\,Е. Володин]{\large \\Володин Сергей Евгеньевич}
\institute{\large Московский физико-технический институт}

\date{\footnotesize{\emph{Курс:} Численные методы обучения по прецедентам\par (практика, В.\,В. Стрижов)/Группа 374, осень 2016}}
%-------------------------------------------------------
\begin{document}
%-------------------------------------------------------
\begin{frame}
%\thispagestyle{empty}
\titlepage
\end{frame}
%-------------------------------------------------------
\begin{frame}{Цель исследования}
\begin{block}{Цель}
Предсказание взаимодействия двух типов молекул: лиганд и рецепторов.
\end{block}
\begin{block}{Проблема}
События реакции лиганда с различными рецепторами не независимы. Классификатор, не учитывающий их, имеет неоптимальный результат.
%В ответах содержатся пропуски, поэтому независимое рассмотрение рецепторов дает неудовлетворительное качество классификации.
	%События реакции лиганда с различными рецепторами не независимы.
%Экспертные знания в области биохимии и фармакологии дают основания пред-
%полагать, что факты связывания одних и тех же молекул с различными рецепторами не
%независимы.
\end{block}
%Оказывается, что события реакции лиганда с различными рецепторами не независимы.
\begin{block}{Задача}
Необходимо построить
\begin{enumerate}
	\item вероятностную модель, учитывающую зависимости
	\item бинарный классификатор
\end{enumerate}
\end{block}
\end{frame}
%-------------------------------------------------------
\begin{frame}{Проблема}
\includegraphics{dependence}
\end{frame}
%-------------------------------------------------------
\begin{frame}{Литература}
\begin{enumerate}
	\item Olexandr Isayev Sherif Farag Stephen J. Capuzzi, Regina Politi and Alexander Tropsha. Qsar
	modeling of tox21 challenge stress response and nuclear receptor signaling toxicity assays.
	\item Geoff Holmes Eibe Frank Jesse Read, Bernhard Pfahringer. Classifier chains for multi-label
	classification.
	\item Eyke H.0 Krzysztof Dembczynski, Weiwei Cheng. Bayes optimal multilabel classification via
	probabilistic classifier chains. 2010.
\end{enumerate}
\end{frame}
%-------------------------------------------------------
\begin{frame}{Постановка задачи}
Задана выборка $\mathfrak{D}=\{(\x_i,\y_i)\}=\mathfrak{L}\sqcup\mathfrak{T}$. $\x_i\in \mathbb{R}^n$. $\y_i\in \{0,1,\Box\}^l$ %, $\Box$~--- пропуск в данных.
	
$\X, \Y$~--- случайные величины %, между классами есть зависимости.
\begin{block}{1. Восстановление плотности}
Модель классификации: функция $\fs=P(\Y=\y|\X=\x;\w)$

Максимизируется правдоподобие выборки:
	
	%Функция потерь~--- логарифм правдоподобия
	%$$Q(\fs|\w, \mathcal{Z})=-\sum_{(\x,\y)\in\mathcal{Z}}\log %\fs(\w,\x,\y)P(\X=\x)$$
	
%	Требуется минимизировать $Q$:
	$$\w^*=\underset{{\w\in\W}}{\arg\max}\ln Q(\fs|\w,\mathfrak{L})$$
	
\end{block}
\begin{block}{2. Бинарный классификатор}
	\begin{enumerate}
		\item Функция потерь $L(\y,\y')$
		\item $h(x)=\underset{\y\in \Y}{\arg\min}\,\mathbb{E}_{\Y|\X=\x}L(\Y,\y)$
	\end{enumerate}
\end{block}

Модели сравниваются по различным метрикам с использованием кросс-валидации.
\end{frame}
%-------------------------------------------------------
\begin{frame}{Решение. Вид модели $\fs$}
Probabilistic Classifier Chains
\begin{enumerate}
\item Выразим искомую величину $P(\y|\x)$: $$P(\y|\x)=P(y_1|\x)\prod_{i=2}^lP(y_i|y_1,...,y_{i-1}, \x)$$

\item Задача распадается на $n$ задач поиска $$P(y_1|\x),\,P(y_2|y_1,\x)...,\,P(y_l|y_1,...,y_{l-1},\x)$$

\item Каждую оцениваем при помощи логистической регрессии.

\item Признаки для $i$-й: $\x$, \bf{а также $y_1,...,y_{i-1}$}
\end{enumerate}
\end{frame}
\begin{frame}{Решение. Бинарный классификатор}
Байесовское решающее правило:
$$h(x)=\underset{\y\in \Y}{\arg\min}\,\mathbb{E}_{\Y|\X=\x}L(\Y,\y)$$
Все зависит от $L(\y,\y')$. Какая лучше?
\begin{enumerate}
\item Hamming Loss: $L(\y,\y')=\sum\limits_{i=1}^l[y_i\neq y'_i]$.\\ $h(x)$ не учитывает зависимости!
\item Subset Loss: $L(\y,\y')=[\y\neq\y']$
\item $L(\y,\y')=q(\sum\limits_{i=1}^l[y_i\neq y'_i])$
\end{enumerate}

Решения для разных существенно различны.
\end{frame}
\begin{frame}{Решение. Бинарный классификатор}
Иллюстрация проблемы
\begin{table}[t] %\small
	\centering\medskip%\tabcolsep=2pt%\small
	\begin{tabular}{lrrrr}
		$y_1$ & $y_2$ & $y_3$ & $y_4$ & $P(\y)$\\
		$0$ & $0$ & $0$ & $0$ & $0.30$\\
		$0$ & $1$ & $1$ & $1$ & $0.17$\\
		$1$ & $0$ & $1$ & $1$ & $0.18$\\
		$1$ & $1$ & $0$ & $1$ & $0.17$\\
		$1$ & $1$ & $1$ & $0$ & $0.18$\\
	\end{tabular}
\end{table}
\begin{enumerate}
\item Лучший по Subset Loss: $(0, 0, 0, 0)$
\item Лучший по Hamming Loss: $(1, 1, 1, 1)$
\end{enumerate}
{\small Krzysztof Dembczynski, Multi-Label Classification: Label Dependence, Loss Minimization, and Reduction Algorithms, 2013 }
\end{frame}
%-------------------------------------------------------
\begin{frame}{Вычислительный эксперимент}
\begin{block}{Цель эксперимента}
\begin{enumerate}
	\item Сравнение бинарных классификаторов
	\item Подбор гиперпараметров
	\item Характеристики алгоритма
\end{enumerate}
\end{block}
\begin{block}{Сравниваемые модели}
\begin{enumerate}
	\item Binary Relevance~--- без зависимостей
	\item {\bf PCC}~--- предлагаемое решение
\end{enumerate}
\end{block}
\end{frame}
\begin{frame}{Вычислительный эксперимент. Модельные данные}
1 признак, $l=3$ класса. Плотность:
\includegraphics[width=0.9\textwidth]{ModelData}
\end{frame}
\begin{frame}{Вычислительный эксперимент. Модельные данные}
\begin{table}[t]\small
	\centering\medskip%\tabcolsep=2pt%\small
	\begin{tabular}{lrrrr}
%		\hline
		Метрика &             BR &         PCC (H) &         PCC (M) &         PCC (S) \\
		AUC 1 &   0.69 $\pm$ 0.03 &  0.69 $\pm$ 0.03 &  0.69 $\pm$ 0.02 &  0.69 $\pm$ 0.05 \\
		AUC 2 &   0.55 $\pm$ 0.04 &  0.55 $\pm$ 0.04 &  0.56 $\pm$ 0.03 &  0.51 $\pm$ 0.04 \\
		AUC 3 &   0.65 $\pm$ 0.04 &  0.66 $\pm$ 0.02 &  0.64 $\pm$ 0.04 &  0.64 $\pm$ 0.04 \\
		Hamming     &  0.37 $\pm$ 0.009 &  0.36 $\pm$ 0.02 &  0.36 $\pm$ 0.02 &  0.38 $\pm$ 0.04 \\
		Hamming 1   &   0.31 $\pm$ 0.03 &  0.31 $\pm$ 0.03 &  0.31 $\pm$ 0.02 &  0.31 $\pm$ 0.05 \\
		Hamming 2   &   0.45 $\pm$ 0.04 &  0.45 $\pm$ 0.04 &  0.45 $\pm$ 0.03 &  0.49 $\pm$ 0.05 \\
		Hamming 3   &   0.34 $\pm$ 0.03 &   0.3 $\pm$ 0.03 &  0.31 $\pm$ 0.04 &  0.34 $\pm$ 0.03 \\
		Precision 1   &    0.7 $\pm$ 0.06 &   0.7 $\pm$ 0.06 &  0.73 $\pm$ 0.05 &  0.64 $\pm$ 0.05 \\
		Precision 2   &   0.55 $\pm$ 0.04 &  0.51 $\pm$ 0.01 &  0.47 $\pm$ 0.04 &  0.46 $\pm$ 0.07 \\
		Precision 3   &    0.7 $\pm$ 0.06 &  0.56 $\pm$ 0.05 &    0.5 $\pm$ 0.1 &  0.66 $\pm$ 0.05 \\
		Recall 1   &   0.68 $\pm$ 0.04 &  0.68 $\pm$ 0.04 &  0.68 $\pm$ 0.03 &  0.71 $\pm$ 0.05 \\
		Recall 2   &    0.52 $\pm$ 0.1 &   0.53 $\pm$ 0.1 &  0.54 $\pm$ 0.09 &  0.48 $\pm$ 0.05 \\
		Recall 3   &    0.48 $\pm$ 0.1 &  0.53 $\pm$ 0.06 &  0.52 $\pm$ 0.07 &  0.49 $\pm$ 0.09 \\
		\bf{Subset}     &   0.78 $\pm$ 0.03 &  0.77 $\pm$ 0.05 &  0.77 $\pm$ 0.05 &  0.62 $\pm$ 0.06 \\
	%	\hline
	\end{tabular}
\end{table}
Есть улучшение только по Subset Loss.
\end{frame}
\begin{frame}{Вычислительный эксперимент. Реальные данные}
Взаимодействие лиганд и рецепторов. Признаки сгенерированы программой биохимической симуляции, ответы~--- результаты экспериментов.
\begin{enumerate}
	\item 165 признаков, 8000 объектов
	\item 12 классов (рецепторов), используется 3.
	\item Высокая мультиколлинеарность
\end{enumerate}
В ответах имеется большое количество пропусков.
\end{frame}
\begin{frame}{Вычислительный эксперимент. Реальные данные}
 1,2,3 = NR-AhR, NR-AR-LBD, NR-Aromatase\\
\begin{table}[t]\footnotesize
	\centering\medskip%\tabcolsep=2pt%\small
	\begin{tabular}{lrrrr}
		{Метрика} &             BR &           PCC (H) &          PCC (M) &           PCC (S) \\
		AUC 1 &   0.58 $\pm$ 0.03 &    0.58 $\pm$ 0.03 &    0.57 $\pm$ 0.02 &    0.58 $\pm$ 0.02 \\
		AUC 2 &   0.61 $\pm$ 0.06 &    0.61 $\pm$ 0.06 &    0.62 $\pm$ 0.06 &    0.61 $\pm$ 0.05 \\
		AUC 3 &   0.55 $\pm$ 0.01 &    0.54 $\pm$ 0.01 &    0.53 $\pm$ 0.01 &    0.54 $\pm$ 0.01 \\
		Hamming     &   0.15 $\pm$ 0.01 &    0.17 $\pm$ 0.01 &    0.19 $\pm$ 0.02 &    0.17 $\pm$ 0.02 \\
		H 1   &   0.21 $\pm$ 0.03 &    0.21 $\pm$ 0.03 &    0.24 $\pm$ 0.02 &    0.21 $\pm$ 0.03 \\
		H 2   &  0.045 $\pm$ 0.01 &  0.041 $\pm$ 0.007 &  0.041 $\pm$ 0.008 &  0.041 $\pm$ 0.006 \\
		H 3   &    0.2 $\pm$ 0.02 &    0.25 $\pm$ 0.01 &    0.29 $\pm$ 0.03 &    0.25 $\pm$ 0.03 \\
		Precision 1   &    0.79 $\pm$ 0.1 &     0.79 $\pm$ 0.1 &     0.79 $\pm$ 0.1 &     0.82 $\pm$ 0.1 \\
		Precision 2   &    0.91 $\pm$ 0.1 &     0.88 $\pm$ 0.1 &     0.91 $\pm$ 0.1 &     0.88 $\pm$ 0.1 \\
		Precision 3   &   0.76 $\pm$ 0.07 &    0.82 $\pm$ 0.09 &    0.78 $\pm$ 0.09 &    0.82 $\pm$ 0.08 \\
		Recall 1   &   0.17 $\pm$ 0.06 &    0.17 $\pm$ 0.06 &    0.15 $\pm$ 0.04 &    0.18 $\pm$ 0.05 \\
		Recall 2   &    0.22 $\pm$ 0.1 &     0.23 $\pm$ 0.1 &     0.24 $\pm$ 0.1 &     0.23 $\pm$ 0.1 \\
		Recall 3   &    0.1 $\pm$ 0.02 &   0.085 $\pm$ 0.02 &   0.071 $\pm$ 0.02 &   0.086 $\pm$ 0.02 \\
		\bf{Subset}     &   0.32 $\pm$ 0.02 &    0.34 $\pm$ 0.02 &    0.46 $\pm$ 0.03 &     0.3 $\pm$ 0.03 \\
	\end{tabular}
\end{table}
Небольшое улучшение по Subset Loss
\end{frame}
\begin{frame}{Вычислительный эксперимент. Размер выборки}
Модельные данные.
\includegraphics[width=0.9\textwidth]{ModelDataTrainSize}\\
150 объектов достаточно.
\end{frame}
\begin{frame}{Заключение}
\begin{block}{Результаты}
\begin{enumerate}
	\item Предложена модель для предсказания взаимодействия, учитывающая зависимости между классами
	\item Проведено сравнение модели с базовой
	\item PCC лучше BR по метрике Subset Loss
	\item Нет улучшений по отдельным классам
\end{enumerate}
\end{block}
\begin{block}{Планы на будущее}
	\begin{enumerate}
		\item Улучшение показателей по классам
		\item Замена логистической регрессии на лучший алгоритм
		\item Вычисление для всей выборки
	\end{enumerate}	
\end{block}

\end{frame}
%-------------------------------------------------------
\end{document} 